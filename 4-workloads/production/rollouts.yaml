---
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: silent-auction-frontend
spec:
  revisionHistoryLimit: 2
  strategy:
    canary:
      minPodsPerReplicaSet: 1
      stableService: silent-auction-frontend-stable
      canaryService: silent-auction-frontend-canary
      scaleDownDelaySeconds: 60
      trafficRouting:
        istio:
          virtualService:
            name: silent-auction-frontend
            routes:
              - silent-auction-frontend
      steps:
        - setWeight: 5
        - pause:
            duration: 10m
---
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: silent-auction-backend
spec:
  revisionHistoryLimit: 2
  strategy:
    canary:
      minPodsPerReplicaSet: 1
      canaryService: silent-auction-backend-canary
      stableService: silent-auction-backend-stable
      scaleDownDelaySeconds: 60
      trafficRouting:
        istio:
          virtualService:
            name: silent-auction-backend
            routes:
              - silent-auction-backend
      steps:
        - setWeight: 5
        - pause:
            duration: 10m
